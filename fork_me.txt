open source code

new version of code
