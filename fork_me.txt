open source code
some code added.